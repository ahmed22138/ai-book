{
  "spec_content": "/sp.specify\n\nTitle: Technical Specification — RAG Chatbot Backend for Physical AI & Humanoid Robotics Book (Docusaurus Integrated)\n\n1. Objective\nBuild a FastAPI backend that powers a Retrieval-Augmented Chatbot connected directly to my Docusaurus book.  \nThe chatbot must answer ONLY from:\n- Docusaurus book content stored in Qdrant, or  \n- User-selected text (when provided)\n\n2. Core Functional Requirements\n- Ingest all Docusaurus book Markdown files into Qdrant (vector DB).\n- Chunk chapters, generate embeddings, and store metadata (chapter, section, slug).\n- RAG pipeline:\n  1) Embed query  \n  2) Search Qdrant  \n  3) Re-rank  \n  4) Build context  \n  5) Generate answer with citations  \n- Support two modes:\n  a) **RAG Mode**: answer from book  \n  b) **Selected Text Mode**: ignore Qdrant and use only user-selected text\n- If no answer found → respond: **“Not in the book.”**\n\n3. Technology Requirements\n- Backend: FastAPI (Python 3.11+)\n- LLM: OpenAI GPT-4.1 or o1-mini (cost optimized)\n- Embeddings: text-embedding-3-large\n- Vector DB: Qdrant Cloud (Free tier)\n- SQL DB: Neon Serverless PostgreSQL\n- Frontend Integration: ChatKit SDK inside Docusaurus React pages\n- Deployment: Railway / Render / Fly.io compatible\n\n4. API Endpoints\n- `POST /ask`  \n  Inputs: query  \n  Output: RAG answer + chapter/section citations  \n- `POST /ask/selected`  \n  Inputs: query, user_text  \n  Output: answer ONLY from user_text  \n- `POST /ingest`  \n  Inputs: folder or files[]  \n  Task: embed + upload book into Qdrant  \n- `GET /health`  \n  Output: status JSON\n\n5. Data Format\nQdrant payload structure:\n{\n  \"chapter\": \"Chapter 04\",\n  \"section\": \"4.2 Robot Locomotion\",\n  \"slug\": \"/docs/ch4/locomotion\",\n  \"text\": \"Full paragraph...\",\n  \"source\": \"docusaurus-book\"\n}\n\n6. Integration Requirements\n- Chatbot UI inside Docusaurus built with ChatKit.\n- Backend URL configurable via environment variable.\n- UI must support:\n  - Live chat  \n  - Displaying citations  \n  - Passing selected text to backend  \n- CORS restricted to local dev + production domain.\n\n7. Constraints\n- Maximum context window: 20k tokens\n- Max user-provided text: 30k characters\n- Response time target: < 3 seconds\n- Zero hallucinations allowed\n\n8. Success Criteria\n- Chatbot answers correctly using only the Docusaurus book.\n- Accurate chapter + section citations.\n"
}